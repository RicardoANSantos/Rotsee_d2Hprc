R script for Monte Carlo simulations to reconstruct δ2H precipitation (δ2Hprc) values from plant wax δ2H (n-C29 alkane) in the Rotsee sediment core, as described in the manuscript "Holocene Hydroclimate Reconstruction in Europe: Overcoming Vegetation Bias in Plant Wax Hydrogen Isotopes" (Santos et al., 2025, submitted to Geophysical Research Letters).
The script performs vegetation-corrected δ²Hprc reconstructions using a relative abundance (R.A) index, computes 68% and 95% confidence intervals, and generates a plot with LOESS smoothing.
Dependencies

R: Version 4.4.1 or higher
R Packages:
ggplot2 (for plotting)
readxl (for reading Excel files)
writexl (for writing Excel files)
dplyr (for data manipulation)
tidyr (for data tidying)Install packages using:


install.packages(c("ggplot2", "readxl", "writexl", "dplyr", "tidyr"))

Files

monte_carlo_d2Hprec.R: Main R script for Monte Carlo simulations, confidence interval calculations, and plotting.
ROT21_Inputs_montecarlo_simulations_d2Hprec.xlsx: Input data file containing Age_BP_ka, d2H_C29, and f_GR columns (different spreadsheets have different f_GR estimators based on different methods).

Output Files (generated by the script):
d2H_precipitation_simulations.xlsx: Raw Monte Carlo simulation results.
d2H_prec_reconstructions_with_CI.xlsx: Summarized results with mean δ²Hprc and confidence intervals.
d2H_precip_plot_with_CI_and_LOESS.png: Plot of δ²Hprc with 68% and 95% CIs and LOESS smoothing.
d2H_precip_plot_with_CI_and_LOESS.pdf: Same plot in PDF format.


Usage

Set Up Environment:

Ensure R and the required packages are installed.
Place the input file (ROT21_Inputs_montecarlo_simulations_d2Hprec.xlsx) in your working directory.
Optionally, set the working directory in the script by uncommenting and modifying the setwd() line.


Run the Script:
source("monte_carlo_d2Hprec.R")

The script will:

Read the input data.
Perform 10,000 Monte Carlo simulations per sample using vegetation-weighted fractionation factors.
Compute mean δ²Hprc and 68%/95% confidence intervals.
Export results to Excel files and generate a plot.


Expected Output:

Excel files with raw and summarized results.
A plot showing δ²Hprc reconstruction with confidence intervals and LOESS smoothing.


Notes

Input Data: The input Excel file is "ROT21_Inputs_MonteCarlo_simulation_d2Hprc.xlsx". Contact the corresponding author (r.n.santos@unibas.ch) for Supporting Information.
Reproducibility: The script uses set.seed(12345) for consistent results.
Reference: Hydrogen fractionation values from Central Europe, please see the manuscript for references and details.

Citation
Please cite the associated manuscript: Santos, R. N., et al. (2025). Holocene Hydroclimate Reconstruction in Europe: Overcoming Vegetation Bias in Plant Wax Hydrogen Isotopes. Geophysical Research Letters (in submission).
Contact
For questions, contact R. N. Santos (r.n.santos@unibas.ch) or S. N. Ladd (n.ladd@unibas.ch).

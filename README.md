## Scripts and Files

- **monte_carlo_d2Hprc.R**: Performs Monte Carlo simulations for vegetation-corrected δ2Hprc reconstruction using an n-alkane relative abundance (R.A) index and hydrogen fractionation factors. Computes 68% and 95% confidence intervals, generates LOESS-smoothed plots.
- **monte_carlo_d2H_residuals.R**: Performs Monte Carlo simulations to compute δ2Hprc residuals after temperature and ice volume/sea level corrections. Builds on outputs from `monte_carlo_d2Hprc.R`.
- **compare_records_non-detrendeds.R**: Compares FI.M6 with other records using correlation metrics (raw, cross-, running), with interpolation, smoothing, and even-grid resampling (non-detrended version).
- **compare_records_detrended.R**: Similar to `compare_records.R` but with linear detrending to focus on variability.
- **ROT21_Inputs_MonteCarlo_simulation_d2Hprc.xlsx**: Input for reconstruction/residuals scripts (Age_BP_ka, d2H_C29, f_GR estimators on different sheets).
- **251027_Inputs to compare d2H prec of Milandra and ROT21_interpolations.xlsx**: Input for comparison scripts (BP and value columns for FI.M6 and other records).

## Output Files (Generated by the Scripts)

### From `monte_carlo_d2Hprc.R`:
- `d2H_precipitation_simulations.csv`: Raw Monte Carlo simulation results.
- `d2H_prec_reconstructions_with_CI.xlsx`: Summarized results with mean δ2Hprc, confidence intervals, and LOESS values.
- `d2H_precip_plot_with_CI_and_LOESS.png/pdf`: Plot of δ2Hprc with CIs and LOESS smoothing.

### From `monte_carlo_d2H_residuals.R`:
- `MonteCarlo_d2H_prc_Residuals.xlsx`: Summarized residuals with means, SDs, and quantiles for 68%/95% CIs.

### From `compare_records.R` and `compare_records_detrended.R`:
- `correlation_summary.txt` or `correlation_summary_detrended.txt`: Text summary of correlations, adjusted p-values, CCF, running correlations, and lag conversions (in years).
- Per-record plots (e.g., `Bayesian_vs_FI_M6_combined.png/pdf`, with "_detrended" suffix for detrended): Combined time-series and running correlation plots.

## Usage

### General Setup:
- Ensure R and packages are installed.
- Place input files in your working directory or update paths in scripts.
- Run scripts via `source("script_name.R")` in R.

### Run `monte_carlo_d2Hprc.R`:
- Adjust f_GR variable (e.g., R.A_fGR sheet) if needed.
- Outputs raw simulations, summarized CIs with LOESS, and plots.
- Uses 10,000 iterations; set.seed(12345) for reproducibility.

### Run `monte_carlo_d2H_residuals.R`:
- Uses outputs from the reconstruction script (e.g., means/CIs as input).
- Applies temperature/ice corrections; outputs residuals with CIs.

### Run `compare_records.R` or `compare_records_detrended.R`:
- Set input_file to the comparison Excel.
- Generates per-record plots and summary TXT.
- Optional: Uncomment print plots or modify records_list for custom methods.

## Notes
- **Input Data**: Contact the corresponding author (r.n.santos@unibas.ch) for supporting information or full datasets.
- **Reproducibility**: Scripts use set.seed() for consistent results.
- **References**: Fractionation values from Central Europe; sea level from Lambeck et al. (2014); temperature coefficient from manuscript. See scripts' headers for caveats (e.g., normal distributions, linear assumptions).
- **Customization**: Adjust parameters (e.g., n_simulations=10000, LOESS span=0.2, grid_res=200) for other datasets.

## Citation
Please cite the associated manuscript: Santos, R. N., et al. (2025). Central Europe hydroclimate since the Younger Dryas from vegetation-corrected sedimentary plant wax δ²H values. Paleoceanography and Paleoclimatology (in submission).

## Contact
For questions, contact R. N. Santos (r.n.santos@unibas.ch) or S. N. Ladd (n.ladd@unibas.ch).
